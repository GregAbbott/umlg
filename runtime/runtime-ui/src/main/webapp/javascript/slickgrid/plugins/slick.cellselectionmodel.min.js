!function(e){function l(l){function n(n){h=e.extend(!0,{},R,l),w=n,g=w.getCanvasNode(),w.onActiveCellChanged.subscribe(a),w.onKeyDown.subscribe(u),n.registerPlugin(d),d.onCellRangeSelected.subscribe(s),d.onBeforeCellRangeSelected.subscribe(r)}function o(){w.onActiveCellChanged.unsubscribe(a),w.onKeyDown.unsubscribe(u),d.onCellRangeSelected.unsubscribe(s),d.onBeforeCellRangeSelected.unsubscribe(r),w.unregisterPlugin(d)}function t(e){for(var l=[],n=0;n<e.length;n++){var o=e[n];w.canCellBeSelected(o.fromRow,o.fromCell)&&w.canCellBeSelected(o.toRow,o.toCell)&&l.push(o)}return l}function c(e){f=t(e),C.onSelectedRangesChanged.notify(f)}function i(){return f}function r(e){return w.getEditorLock().isActive()?(e.stopPropagation(),!1):void 0}function s(e,l){c([l.range])}function a(e,l){h.selectActiveCell&&null!=l.row&&null!=l.cell&&c([new Slick.Range(l.row,l.cell)])}function u(e){var l,n,o=w.getActiveCell();if(o&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&(37==e.which||39==e.which||38==e.which||40==e.which)){l=i(),l.length||l.push(new Slick.Range(o.row,o.cell)),n=l.pop(),n.contains(o.row,o.cell)||(n=new Slick.Range(o.row,o.cell));var r=n.toRow-n.fromRow,s=n.toCell-n.fromCell,a=o.row==n.fromRow?1:-1,u=o.cell==n.fromCell?1:-1;37==e.which?s-=u:39==e.which?s+=u:38==e.which?r-=a:40==e.which&&(r+=a);var g=new Slick.Range(o.row,o.cell,o.row+a*r,o.cell+u*s);if(t([g]).length){l.push(g);var h=a>0?g.toRow:g.fromRow,f=u>0?g.toCell:g.fromCell;w.scrollRowIntoView(h),w.scrollCellIntoView(h,f)}else l.push(n);c(l),e.preventDefault(),e.stopPropagation()}}var w,g,h,f=[],C=this,d=new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}}),R={selectActiveCell:!0};e.extend(this,{getSelectedRanges:i,setSelectedRanges:c,init:n,destroy:o,onSelectedRangesChanged:new Slick.Event})}e.extend(!0,window,{Slick:{CellSelectionModel:l}})}(jQuery);