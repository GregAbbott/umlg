!function(t){function i(i){function e(t){var i=t.val();return""==i?null:i}t.extend(this,{TumlTextEditor:"1.0.0",serializeValueWithValue:e});var n,a;this.init=function(){n=t("<INPUT type='text' class='slick-grid-umlg-editor-text' />").appendTo(i.container).bind("keydown.nav",function(i){(i.keyCode===t.ui.keyCode.LEFT||i.keyCode===t.ui.keyCode.RIGHT)&&i.stopImmediatePropagation()}).focus().select()},this.destroy=function(){n.remove()},this.focus=function(){n.focus()},this.getValue=function(){return n.val()},this.setValue=function(t){n.val(t)},this.loadValue=function(t){a=t[i.column.field]||null,n.val(a),n[0].defaultValue=a,n.select()},this.serializeValue=function(){return e(n)},this.applyValue=function(t,e){t[i.column.field]=e},this.isValueChanged=function(){return n.val()!=a},this.validate=function(){if(i.column.validator){var t=i.column.validator(n.val());if(!t.valid)return t}return{valid:!0,msg:null}},void 0!==i&&this.init()}function e(i){this.args=i,this.$input,this.$table;var e;this.handleKeyPress=function(t){t.target==this.$input[0]&&13==t.which&&(this.addButton.click(),t.stopImmediatePropagation())},this.destroy=function(){this.args.grid.manyPrimitiveEditorOpen=!1,this.panel.remove()},this.focus=function(){this.$input.focus()},this.loadValue=function(t){if(e=t[this.args.column.field],void 0!==e&&null!==e){for(var i=0;i<e.length;i++)this.addTr(e[i]);this.args.column.options.ordered&&this.$table.tableDnD()}},this.addTr=function(i){var e=t("<tr />").addClass("many-primitive-editor-row"),n=t('<td class="many-primitive-editor-cell" />').text(i);e.append(n),e.data("value",i);var a=t('<img class="umlg-many-select-img" src="/'+tumlModelName+'/javascript/images/delete.png">').click(function(){var i=t(this).parent().parent();i.remove()}),o=t('<td class="many-primitive-editor-cell many-primitive-editor-cell-img" />');o.append(a),e.append(o),this.$table.append(e)},this.applyValue=function(t,i){t[this.args.column.field]=i},this.isValueChanged=function(){for(var i=this.$table.find(".many-primitive-editor-row"),n=[],a=0;a<i.length;a++){var o=i[a];n.push(t(o).data("value"))}var l=!1;if(void 0!==e&&null!==e&&e.length==n.length){for(var a=0;a<n.length;a++)if(e[a]!=n[a]){l=!0;break}}else l=!0;return l},this.validate=function(){if(this.args.column.validator){var i=this.$table.find(".many-primitive-editor-row");if(i.length>0){for(var e=[],n=0;n<i.length;n++){var a=i[n];e.push(t(a).data("value"))}var o=this.args.column.validator(e);if(!o.valid)return o}}return{valid:!0,msg:null}},void 0!==this.args&&this.init()}function n(t){this.args=t,void 0!==this.args&&this.init()}function a(t){this.args=t,void 0!==this.args&&(this.$item=t.item,this.init())}function o(t){this.args=t,void 0!==this.args&&(this.$item=t.item,this.init())}function l(t){this.args=t,void 0!==this.args&&(this.$item=t.item,this.init())}function r(t){this.args=t,void 0!==this.args&&(this.$item=t.item,this.init())}function u(t){this.args=t,void 0!==this.args&&this.init()}function s(t){this.args=t,void 0!==this.args&&this.init()}function d(i){function e(t){return parseInt(t.val(),10)||0}t.extend(this,{TumlIntegerEditor:"1.0.0",serializeValueWithValue:e});var n,a;this.init=function(){n=t("<INPUT type=text class='slick-grid-umlg-editor-text' />"),n.bind("keydown.nav",function(i){(i.keyCode===t.ui.keyCode.LEFT||i.keyCode===t.ui.keyCode.RIGHT)&&i.stopImmediatePropagation()}),n.appendTo(i.container),n.focus().select()},this.destroy=function(){n.remove()},this.focus=function(){n.focus()},this.loadValue=function(t){a=t[i.column.field],n.val(a),n[0].defaultValue=a,n.select()},this.serializeValue=function(){return e(n)},this.applyValue=function(t,e){t[i.column.field]=e},this.isValueChanged=function(){return!(""==n.val()&&null==a)&&n.val()!=a},this.validate=function(){if(i.column.validator){var t=i.column.validator(n.val());if(!t.valid)return t}return{valid:!0,msg:null}},void 0!==i&&this.init()}function c(i){function e(t){return parseFloat(t.val())||0}t.extend(this,{TumlDoubleEditor:"1.0.0",serializeValueWithValue:e});var n,a;this.init=function(){n=t("<INPUT type=text class='slick-grid-umlg-editor-text' />"),n.bind("keydown.nav",function(i){(i.keyCode===t.ui.keyCode.LEFT||i.keyCode===t.ui.keyCode.RIGHT)&&i.stopImmediatePropagation()}),n.appendTo(i.container),n.focus().select()},this.destroy=function(){n.remove()},this.focus=function(){n.focus()},this.loadValue=function(t){a=t[i.column.field],n.val(a),n[0].defaultValue=a,n.select()},this.serializeValue=function(){return e(n)},this.applyValue=function(t,e){t[i.column.field]=e},this.isValueChanged=function(){return!(""==n.val()&&null==a)&&n.val()!=a},this.validate=function(){if(i.column.validator){var t=i.column.validator(n.val());if(!t.valid)return t}return{valid:!0,msg:null}},void 0!==i&&this.init()}function p(i){function e(t){return t.val()}t.extend(this,{TumlDateEditor:"1.0.0",serializeValueWithValue:e});var n,a,o=!1;this.init=function(){n=t("<INPUT type='text' class='slick-grid-umlg-editor-text' />"),n.appendTo(i.container),n.focus().select(),n.datepicker({showOn:"button",buttonImageOnly:!0,buttonImage:"/"+tumlModelName+"/javascript/slickgrid/images/calendar.gif",dateFormat:"yy-mm-dd",beforeShow:function(){o=!0},onClose:function(){o=!1}}),n.width(n.width()-18)},this.destroy=function(){t.datepicker.dpDiv.stop(!0,!0),n.datepicker("hide"),n.datepicker("destroy"),n.remove()},this.show=function(){o&&t.datepicker.dpDiv.stop(!0,!0).show()},this.hide=function(){o&&t.datepicker.dpDiv.stop(!0,!0).hide()},this.focus=function(){n.is(":hidden")||n.focus()},this.loadValue=function(t){a=t[i.column.field],void 0!==a&&null!==a&&n.datepicker("setDate",new Date(a)),n.select()},this.serializeValue=function(){return e(n)},this.applyValue=function(t,e){t[i.column.field]=e},this.isValueChanged=function(){return!(""==n.val()&&null==a)&&n.val()!=a},this.validate=function(){if(i.column.validator){var t=i.column.validator(n.val());if(!t.valid)return t}return{valid:!0,msg:null}},void 0!==i&&this.init()}function h(i){function e(t){return t.val()}t.extend(this,{TumlDateTimeEditor:"1.0.0",serializeValueWithValue:e});var n,a,o=!1;this.init=function(){n=t("<INPUT type='text' class='slick-grid-umlg-editor-text' />"),n.appendTo(i.container),n.focus().select(),n.datetimepicker({showOn:"button",buttonImageOnly:!0,buttonImage:"/"+tumlModelName+"/javascript/slickgrid/images/calendar.gif",dateFormat:"yy-mm-dd",timeFormat:"hh:mm:ss",beforeShow:function(){o=!0},onClose:function(){o=!1}}),n.width(n.width()-18)},this.destroy=function(){t.datepicker.dpDiv.stop(!0,!0),n.datepicker("hide"),n.datepicker("destroy"),n.remove()},this.show=function(){o&&t.datepicker.dpDiv.stop(!0,!0).show()},this.hide=function(){o&&t.datepicker.dpDiv.stop(!0,!0).hide()},this.focus=function(){n.focus()},this.loadValue=function(t){a=t[i.column.field],null!==a&&n.datetimepicker("setDate",new Date(a)),n.select()},this.serializeValue=function(){return e(n)},this.applyValue=function(t,e){t[i.column.field]=e},this.isValueChanged=function(){return!(""==n.val()&&null==a)&&n.val()!=a},this.validate=function(){if(i.column.validator){var t=i.column.validator(n.val());if(!t.valid)return t}return{valid:!0,msg:null}},void 0!==i&&this.init()}function f(i){function e(t){return t.val()}t.extend(this,{TumlTimeEditor:"1.0.0",serializeValueWithValue:e});var n,a,o=!1;this.init=function(){n=t("<INPUT type='text' class='slick-grid-umlg-editor-text' />"),n.appendTo(i.container),n.focus().select(),n.timepicker({showOn:"button",buttonImageOnly:!0,buttonImage:"/"+tumlModelName+"/javascript/slickgrid/images/calendar.gif",beforeShow:function(){o=!0},onClose:function(){o=!1}}),n.width(n.width()-18)},this.destroy=function(){t.datepicker.dpDiv.stop(!0,!0),n.datepicker("hide"),n.datepicker("destroy"),n.remove()},this.show=function(){o&&t.datepicker.dpDiv.stop(!0,!0).show()},this.hide=function(){o&&t.datepicker.dpDiv.stop(!0,!0).hide()},this.focus=function(){n.focus()},this.loadValue=function(t){if(a=t[i.column.field],null!==a){var e=a.indexOf(":"),o=a.indexOf(":",e+1),l=a.substring(0,e),r=a.substring(e+1,o);n.datetimepicker("setDate",new Date(0,0,0,parseInt(l),parseInt(r),0))}n.select()},this.serializeValue=function(){return e(n)},this.applyValue=function(t,e){t[i.column.field]=e},this.isValueChanged=function(){return!(""==n.val()&&null==a)&&n.val()!=a},this.validate=function(){if(i.column.validator){var t=i.column.validator(n.val());if(!t.valid)return t}return{valid:!0,msg:null}},void 0!==i&&this.init()}function v(i){function e(t){return"checked"==t.attr("checked")}t.extend(this,{TumlCheckBoxEditor:"1.0.0",serializeValueWithValue:e});var n,a;this.init=function(){n=t("<INPUT type=checkbox value='true' class='editor-checkbox' hideFocus>"),n.appendTo(i.container),n.focus()},this.destroy=function(){n.remove()},this.focus=function(){n.focus()},this.loadValue=function(t){a=t[i.column.field],a?n.attr("checked","checked"):n.removeAttr("checked")},this.serializeValue=function(){return e(n)},this.applyValue=function(t,e){t[i.column.field]=e},this.isValueChanged=function(){return"checked"==n.attr("checked")&&1!=a?!0:"checked"!==n.attr("checked")&&0!=a?!0:!1},this.validate=function(){return{valid:!0,msg:null}},void 0!==i&&this.init()}function m(i){function e(t){return t.val()}t.extend(this,{TumlSelectEnumerationCellEditor:"1.0.0",serializeValueWithValue:e});var n,a;this.init=function(e){n=t("<SELECT tabIndex='0' class='editor-select' style='width:115px;'></SELECT>"),n.appendTo(i.container),i.column.options.rowEnumerationLookupMap.getOrLoadMap(function(o){i.column.options.required||n.append(t("<option />)").val("").html("")),t.each(o,function(i,e){n.append(t("<option />)").val(e).html(e))}),a=e[i.column.field],n.val(a),i.column.options.required?n.chosen():n.chosen({allow_single_deselect:!0}),n.focus()})},this.destroy=function(){n.remove()},this.focus=function(){n.focus()},this.loadValue=function(){},this.serializeValue=function(){return i.column.options?e(n):void alert("why is this happening?")},this.applyValue=function(t,e){t[i.column.field]=e},this.isValueChanged=function(){return null===a||void 0===a?!0:n.val()!=a},this.validate=function(){if(i.column.validator){var t=i.column.validator(n.val());if(!t.valid)return t}return{valid:!0,msg:null}},void 0!==i&&this.init(i.item)}function g(i){function e(t){for(var i=t.children(),e=0;e<i.length;e++)if(i[e].selected){var n=t.val();return""===n?{id:null,displayName:null,previousId:a.id}:{id:t.val(),displayName:i[e].label,previousId:a.id}}}t.extend(this,{TumlSelectOneToOneEditor:"1.0.0",serializeValueWithValue:e});var n,a;this.init=function(e){n=t("<SELECT tabIndex='0' class='editor-select' style='width:115px;'></SELECT>"),n.appendTo(i.container);var o=i.column.options.property.tumlLookupUri,l=e.id,r=o.replace(new RegExp("{(s*?.*?)*?}","gi"),l),u=i.column.options.tumlBaseGridManager,s=i.grid.getActiveCell().row;s>=i.grid.getDataLength()?u.handleAddNewRow():u.handleLookup(r,e.qualifiedName,function(o){i.column.options.required||n.append(t("<option />)").val("").html(""));for(var l=0;l<o.length;l++){var r=o[l];n.append(t("<option />)").val(r.id).html(r.name))}a=e[i.column.field],void 0!==a&&null!==a&&n.append(t('<option selected="selected"/>)').val(a.id).html(a.displayName)),i.column.options.required?n.chosen():n.chosen({allow_single_deselect:!0}),n.focus()})},this.destroy=function(){n.remove()},this.focus=function(){n.focus()},this.loadValue=function(){},this.serializeValue=function(){return i.column.options?e(n):void alert("why is this happening? 2")},this.applyValue=function(t,e){t[i.column.field]=e},this.isValueChanged=function(){return null===a||void 0===a?!0:n.val()!=a.id},this.validate=function(){if(i.column.validator){var t=i.column.validator(n.val());if(!t.valid)return t}return{valid:!0,msg:null}},void 0!==i&&this.init(i.item)}function y(i){function e(t){for(var i=t.children(),e=0;e<i.length;e++)if(i[e].selected){var n=t.val();return""===n?{id:null,displayName:null,previousId:a.id}:{id:t.val(),displayName:i[e].label,previousId:a.id}}}t.extend(this,{SelectToOneAssociationClassCellEditor:"1.0.0",serializeValueWithValue:e});var n,a;this.init=function(e){n=t("<SELECT tabIndex='0' class='editor-select' style='width:115px;'></SELECT>"),n.appendTo(i.container);var o=i.column.options.property.tumlLookupUri,l=e.id,r=o.replace(new RegExp("{(s*?.*?)*?}","gi"),l),u=i.column.options.tumlBaseGridManager,s=i.grid.getActiveCell().row;s>=i.grid.getDataLength()?u.handleAddNewRow():u.handleLookup(r,e.qualifiedName,function(o){i.column.options.required||n.append(t("<option />)").val("").html(""));for(var l=0;l<o.length;l++){var r=o[l];n.append(t("<option />)").val(r.id).html(r.name))}a=e[i.column.field],void 0!==a&&null!==a&&n.append(t('<option selected="selected"/>)').val(a.id).html(a.displayName)),i.column.options.required?n.chosen():n.chosen({allow_single_deselect:!0}),n.focus()})},this.destroy=function(){n.remove()},this.focus=function(){n.focus()},this.loadValue=function(){},this.serializeValue=function(){return i.column.options?e(n):void alert("why is this happening? 2")},this.applyValue=function(t,e){if(t[i.column.field]=e,null!==t[i.column.field].id){var n="fake::"+Tuml.TumlFakeIndex++;t[i.column.options.property.associationClassPropertyName]={id:n,tmpId:n,displayName:null,refreshFromDb:!0}}else t[i.column.options.property.associationClassPropertyName]={id:null,tmpId:null,displayName:null,refreshFromDb:!1}},this.isValueChanged=function(){return null===a||void 0===a?!0:void 0!==a.id&&null!==a.id||""!=n.val()?n.val()!=a.id:!1},this.validate=function(){if(i.column.validator){var t=i.column.validator(n.val());if(!t.valid)return t}return{valid:!0,msg:null}},void 0!==i&&this.init(i.item)}t.extend(!0,window,{Tuml:{Slick:{Editors:{Integer:d,Double:c,Text:i,SelectOneToOneCellEditor:g,SelectToOneAssociationClassCellEditor:y,SelectEnumerationCellEditor:m,ManyPrimitiveEditor:e,ManyStringPrimitiveEditor:n,ManyEnumerationEditor:a,ManyIntegerPrimitiveEditor:u,ManyBooleanPrimitiveEditor:s,Checkbox:v,ManyDateEditor:o,ManyTime:l,ManyDateTime:r,Date:p,DateTime:h,Time:f}}}}),e.prototype.serializeEditorValue=function(){alert("serializeEditorValue must be overriden")},e.prototype.serializeValue=function(){alert("this must be overriden")},e.prototype.createInput=function(i){var e=t('<input type=text class="many-primitive-editor-input">');return i.append(e),e},e.prototype.resetInput=function(t){t.val("")},e.prototype.init=function(){void 0!==this.args&&(this.args.grid.manyPrimitiveEditorOpen=!0,this.args.grid.manyPrimitiveEditor=this),this.panel=t("<div class='umlg-panel-many-editor panel panel-default many-primitive-editor' />");var i=t('<div class="panel-heading umlg-panel-heading-popup" />').appendTo(this.panel),e=t('<div class="collapse navbar-collapse" />').appendTo(i),n=t('<div class="panel-body" />').appendTo(this.panel),a=this;this.addButton=t('<button type="button" id="many-primitive-editor-input-add-button" class="btn btn-default pull-left" />').text("Add").click(function(){var t=a.$input.val(),i=a.serializeValue(),e=[];e.push(t);var n=a.args.column.validator(e);if(0!==i.length&&n.valid&&a.args.column.options.unique){var o=a.serializeEditorValue(t);n=a.args.column.validator(i,o)}n.valid?(a.addTr(t),a.args.column.options.ordered&&a.$table.tableDnD(),a.resetInput(a.$input)):alert(n.msg)}).appendTo(e);var o=t('<div class="form-group pull-left" />');this.$input=this.createInput(o),this.$input.addClass("form-control"),o.appendTo(e);var l=t('<div class="many-primitive-editor-result" />').appendTo(n);this.$table=t('<table class="table table-bordered many-primitive-editor-result-table" />').appendTo(l),this.panel.bind("keydown.nav",function(i){(i.keyCode===t.ui.keyCode.LEFT||i.keyCode===t.ui.keyCode.RIGHT)&&i.stopImmediatePropagation()}),this.panel.appendTo(this.args.container),this.$input.focus().select()},n.prototype=new Tuml.Slick.Editors.ManyPrimitiveEditor,n.prototype.serializeEditorValue=function(t){return t},n.prototype.serializeValueForOne=function(i){for(var e=i.find(".many-primitive-editor-row"),n=[],a=0;a<e.length;a++){var o=e[a];n.push(t(o).data("value"))}return n},n.prototype.serializeValue=function(){for(var i=this.$table.find(".many-primitive-editor-row"),e=[],n=0;n<i.length;n++){var a=i[n];e.push(t(a).data("value"))}return e},n.prototype.serializeValueWithValue=function(){alert("ManyStringPrimitiveEditor.prototype.serializeValueWithValue must be overriden!")},a.prototype=new Tuml.Slick.Editors.ManyStringPrimitiveEditor,a.prototype.createInput=function(i){var e=t("<SELECT id='aaaaaaaaaId' tabIndex='0' class='editor-select many-primitive-editor-input'></SELECT>");e.appendTo(i);var n=this;return this.args.column.options.rowEnumerationLookupMap.getOrLoadMap(function(i){n.args.column.options.required||e.append(t("<option />)").val("").html("")),t.each(i,function(i,n){e.append(t("<option />)").val(n).html(n))});var a=n.$item[n.args.column.field];e.val(a),n.args.column.options.required?e.chosen():e.chosen({allow_single_deselect:!0}),e.focus()}),e},a.prototype.resetInput=function(t){t.val("").trigger("liszt:updated")},o.prototype=new Tuml.Slick.Editors.ManyStringPrimitiveEditor,o.prototype.createInput=function(i){var e=t("<INPUT type=text />");return e.appendTo(i),e.focus().select(),e.datepicker({showOn:"button",buttonImageOnly:!0,buttonImage:"../javascript/slickgrid/images/calendar.gif",dateFormat:"yy-mm-dd",beforeShow:function(){calendarOpen=!0},onClose:function(){calendarOpen=!1}}),e},l.prototype=new Tuml.Slick.Editors.ManyStringPrimitiveEditor,l.prototype.createInput=function(i){var e=t("<INPUT type=text />");return e.appendTo(i),e.focus().select(),e.timepicker({showOn:"button",buttonImageOnly:!0,buttonImage:"../javascript/slickgrid/images/calendar.gif",beforeShow:function(){calendarOpen=!0},onClose:function(){calendarOpen=!1}}),e},r.prototype=new Tuml.Slick.Editors.ManyStringPrimitiveEditor,r.prototype.createInput=function(i){var e=t("<INPUT type=text />");return e.appendTo(i),e.focus().select(),e.datetimepicker({showOn:"button",buttonImageOnly:!0,buttonImage:"../javascript/slickgrid/images/calendar.gif",dateFormat:"yy-mm-dd",timeFormat:"hh:mm:ss",beforeShow:function(){calendarOpen=!0},onClose:function(){calendarOpen=!1}}),e},u.prototype=new Tuml.Slick.Editors.ManyPrimitiveEditor,u.prototype.serializeEditorValue=function(t){return parseInt(t,10)},u.prototype.serializeValueForOne=function(i){for(var e=i.find(".many-primitive-editor-row"),n=[],a=0;a<e.length;a++){var o=e[a];n.push(parseInt(t(o).data("value"),10))}return n},u.prototype.serializeValue=function(){for(var i=this.$table.find(".many-primitive-editor-row"),e=[],n=0;n<i.length;n++){var a=i[n];e.push(parseInt(t(a).data("value"),10))}return e},s.prototype=new Tuml.Slick.Editors.ManyPrimitiveEditor,s.prototype.serializeEditorValue=function(t){var i="true"===t||"t"===t||"1"===t,e="false"===t||"f"===t||"0"===t;if(i)return!0;if(e)return!1;throw"Incorrect value for ManyBooleanPrimitiveEditor.prototype.serializeEditorValue: "+t},s.prototype.serializeValueForOne=function(i){for(var e=i.find(".many-primitive-editor-row"),n=[],a=0;a<e.length;a++){var o=e[a],l=t(o).data("value"),r="true"===l||"t"===l||"1"===l;n.push(r)}return n},s.prototype.serializeValue=function(){for(var i=this.$table.find(".many-primitive-editor-row"),e=[],n=0;n<i.length;n++){var a=i[n],o=t(a).data("value"),l="true"===o||"t"===o||"1"===o||o;e.push(l)}return e}}(jQuery);